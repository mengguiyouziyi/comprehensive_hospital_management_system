# 后端开发规则

## 技术栈
- 主要语言：Node.js (NestJS) / Java (Spring Boot)
- 数据库：MySQL 8.0+、Redis 6.0+、MongoDB 5.0+
- API规范：RESTful API + GraphQL
- 身份认证：JWT + OAuth2
- 消息队列：RabbitMQ / Apache Kafka

## 微服务架构规范

### 服务拆分原则
1. 按业务领域拆分服务
2. 单一职责原则
3. 高内聚低耦合
4. 独立部署和扩展

### 服务间通信
1. 同步通信使用RESTful API或GraphQL
2. 异步通信使用消息队列
3. 使用API网关统一入口

## API设计规范

### RESTful API设计
1. 使用名词复数形式表示资源
2. 使用标准HTTP方法：
   - GET：查询资源
   - POST：创建资源
   - PUT：全量更新资源
   - PATCH：部分更新资源
   - DELETE：删除资源
3. 合理使用HTTP状态码
4. 统一响应格式：
   ```json
   {
     "code": 0,
     "message": "success",
     "data": {}
   }
   ```

### 数据库设计规范
1. 遵循数据库范式，减少数据冗余
2. 合理设计索引，提高查询效率
3. 敏感数据加密存储
4. 表名使用小写字母，单词间用下划线分隔
5. 字段名使用下划线命名法

## 安全规范

### 身份认证
1. 使用JWT进行无状态认证
2. Token设置合理的过期时间
3. 敏感操作需要二次验证

### 权限控制
1. 基于角色的访问控制(RBAC)
2. 细粒度权限控制
3. 接口级别的权限验证

### 数据安全
1. 所有密码必须使用强哈希算法加密
2. 敏感信息传输必须使用HTTPS
3. SQL查询使用参数化查询防止注入攻击
4. 文件上传需要进行安全检查

## 日志规范

### 日志级别
1. ERROR：错误信息，需要立即处理
2. WARN：警告信息，需要关注
3. INFO：一般信息，记录关键操作
4. DEBUG：调试信息，开发环境使用

### 日志内容
1. 包含请求ID便于追踪
2. 记录关键业务操作
3. 记录异常堆栈信息
4. 避免记录敏感信息